<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Minimal Bonus ¬∑ TMA</title>
    <!-- Google Fonts: —á–∏—Å—Ç—ã–π –≥—Ä–æ—Ç–µ—Å–∫ -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:opsz@14..32&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        /* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) */
        :root {
            --bg: #f8f9fc;
            --surface: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --accent-soft: #4f46e5; /* –º—è–≥–∫–∏–π –∏–Ω–¥–∏–≥–æ */
            --accent-light: #e0e7ff;
            --bonus: #0ea5e9;        /* —Å–≤–µ–∂–∏–π –≥–æ–ª—É–±–æ–π */
            --success: #10b981;
            --warning: #f59e0b;
            --border-subtle: #e9eef2;
            --shadow-sm: 0 8px 20px -6px rgba(0, 0, 0, 0.05);
            --radius-lg: 28px;
            --radius-md: 18px;
            --radius-sm: 14px;
            --transition: all 0.2s cubic-bezier(0.23, 1, 0.32, 1);
        }

        /* –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ (–ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∫–ª–∞—Å—Å –Ω–∞ body) */
        body.dark {
            --bg: #0f172a;
            --surface: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --accent-soft: #818cf8;
            --accent-light: #334155;
            --bonus: #38bdf8;
            --border-subtle: #334155;
            --shadow-sm: 0 8px 20px -6px rgba(0, 0, 0, 0.5);
        }

        body {
            background-color: var(--bg);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            transition: background-color 0.3s, color 0.2s;
            padding: 0 0 20px 0;
            margin: 0;
            line-height: 1.4;
            font-weight: 400;
        }

        /* –≥–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä ‚Äî –∏–º–∏—Ç–∞—Ü–∏—è —ç–∫—Ä–∞–Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è */
        .app-container {
            width: 100%;
            max-width: 420px;
            background-color: var(--bg);
            padding: 20px 18px 28px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* ----- –ø–ª–æ—Å–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ / —ç–ª–µ–º–µ–Ω—Ç—ã ----- */
        .card {
            background-color: var(--surface);
            border-radius: var(--radius-lg);
            padding: 22px 20px;
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
            border: 1px solid transparent;
        }

        .card-subtle {
            background-color: transparent;
            border: 1px solid var(--border-subtle);
            box-shadow: none;
            border-radius: var(--radius-md);
            padding: 16px 18px;
        }

        /* –ø–ª–æ—Å–∫–∏–µ –∫–Ω–æ–ø–∫–∏ */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border: none;
            background: var(--accent-light);
            color: var(--accent-soft);
            font-weight: 600;
            font-size: 1rem;
            padding: 14px 22px;
            border-radius: 50px; /* –º—è–≥–∫–∏–µ –∫–∞–ø—Å—É–ª—ã, –Ω–æ –ø–ª–æ—Å–∫–∏–µ */
            transition: var(--transition);
            cursor: pointer;
            width: fit-content;
            border: 1px solid transparent;
            line-height: 1;
            gap: 8px;
        }

        .btn-primary {
            background: var(--accent-soft);
            color: white;
        }

        .btn-block {
            width: 100%;
            justify-content: center;
        }

        .btn:active {
            transform: scale(0.97);
            opacity: 0.8;
        }

        /* –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä (–º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π) */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border-subtle);
            border-radius: 20px;
            margin: 12px 0 6px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--accent-soft);
            width: 0%;
            border-radius: 20px;
            transition: width 0.4s ease;
        }

        /* –∏–∫–æ–Ω–∫–∏ / —Ü–∏—Ñ—Ä—ã */
        .flex-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
        }

        .balance-large {
            font-size: 2.6rem;
            font-weight: 500;
            letter-spacing: -0.02em;
            line-height: 1;
            color: var(--text-primary);
        }

        .badge {
            background: var(--accent-light);
            padding: 4px 12px;
            border-radius: 40px;
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--accent-soft);
        }

        .stat-value {
            font-weight: 600;
            font-size: 1.4rem;
            color: var(--text-primary);
        }

        .hint-text {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* –∞–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è —Ü–∏—Ñ—Ä (–ª—ë–≥–∫–∏–π pop) */
        @keyframes gentlePop {
            0% { opacity: 0; transform: translateY(6px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        .animate-balance {
            animation: gentlePop 0.3s ease forwards;
        }

        /* —ç–∫—Ä–∞–Ω –ø–æ–¥–ø–∏—Å–∫–∏ (–æ–≤–µ—Ä–ª–µ–π) */
        .subscription-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: var(--bg);
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 24px;
            backdrop-filter: blur(2px);
        }

        .sub-card {
            background: var(--surface);
            border-radius: var(--radius-lg);
            padding: 32px 24px;
            text-align: center;
            max-width: 360px;
            box-shadow: var(--shadow-sm);
        }

        .channel-list {
            background: var(--accent-light);
            border-radius: var(--radius-sm);
            padding: 12px;
            margin: 20px 0;
            font-size: 0.95rem;
            color: var(--text-primary);
            opacity: 0.9;
        }

        /* –º–∞–ª–µ–Ω—å–∫–∏–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ */
        hr {
            border: none;
            border-top: 1px solid var(--border-subtle);
            margin: 16px 0;
        }

        /* –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 380px) {
            .app-container { padding: 16px; }
            .balance-large { font-size: 2.2rem; }
        }

        /* —Å–∫—Ä—ã—Ç–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
        .hidden {
            display: none !important;
        }

        /* –∫–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã (–º–∏–Ω–∏) */
        .theme-toggle {
            background: var(--surface);
            border: 1px solid var(--border-subtle);
            border-radius: 40px;
            padding: 8px 14px;
            font-size: 0.85rem;
            color: var(--text-secondary);
            cursor: pointer;
            align-self: flex-end;
            transition: var(--transition);
        }
        .theme-toggle:active { opacity: 0.6; }
    </style>
</head>
<body class="">
    <!-- –≠–ö–†–ê–ù –ü–û–î–ü–ò–°–ö–ò (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –≤–∏–¥–µ–Ω) -->
    <div id="subscriptionScreen" class="subscription-overlay">
        <div class="sub-card">
            <div style="font-size: 38px; margin-bottom: 12px;">üì¢</div>
            <h2 style="font-weight: 500; margin-bottom: 8px;">–ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ –∫–∞–Ω–∞–ª—ã</h2>
            <p class="hint-text" style="margin-bottom: 24px;">–ß—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º, –Ω—É–∂–Ω–æ –±—ã—Ç—å –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–º</p>
            
            <!-- –°–ø–∏—Å–æ–∫ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤ (–∏–º–∏—Ç–∞—Ü–∏—è) -->
            <div class="channel-list flex-row" style="justify-content: center; gap: 16px;">
                <span>@bonus_news</span>
                <span>@daily_offers</span>
                <span>@crypto_trend</span>
            </div>

            <!-- –ü–ª–æ—Å–∫–∞—è –∫–Ω–æ–ø–∫–∞ –ü–û–î–ü–ò–°–ê–¢–¨–°–Ø (–∏–º–∏—Ç–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏) -->
            <button class="btn btn-primary btn-block" id="fakeSubscribeBtn" style="margin-top: 12px;">
                ‚úÖ –Ø –ø–æ–¥–ø–∏—Å–∞–ª—Å—è
            </button>
            <p class="hint-text" style="margin-top: 20px; font-size: 0.8rem;">* –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è</p>
        </div>
    </div>

    <!-- –û–°–ù–û–í–ù–û–ô –ò–ù–¢–ï–†–§–ï–ô–° (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç) -->
    <div id="mainApp" class="app-container hidden">

        <!-- –®–∞–ø–∫–∞: –±–∞–ª–∞–Ω—Å –∏ —Ç–µ–º–∞ -->
        <div class="flex-row" style="margin-bottom: 4px;">
            <div>
                <span class="badge">üí∞ –ë–∞–ª–∞–Ω—Å</span>
            </div>
            <button class="theme-toggle" id="themeSwitch">üåì —Ç—ë–º–Ω–∞—è</button>
        </div>

        <!-- –ö—Ä—É–ø–Ω—ã–π –±–∞–ª–∞–Ω—Å —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π -->
        <div class="card" style="padding: 22px 20px;">
            <div class="flex-row" style="margin-bottom: 2px;">
                <span class="balance-large" id="balanceDisplay">0</span>
                <span style="font-size: 1.2rem; color: var(--text-secondary);">‚ÇΩ</span>
            </div>
            <div class="flex-row hint-text">
                <span>–¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –≤—ã–≤–æ–¥–∞</span>
                <span id="minWithdrawHint">–º–∏–Ω. 50 ‚ÇΩ</span>
            </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ –±–æ–Ω—É—Å–∞ –∑–∞ —Ä–µ–∫–ª–∞–º—É (–ø–ª–æ—Å–∫–∞—è, —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π) -->
        <button class="btn btn-block" id="bonusBtn" style="background: var(--bonus); color: white; padding: 18px; font-size: 1.2rem;">
            üéÅ –ü–æ–ª—É—á–∏—Ç—å –±–æ–Ω—É—Å (1‚Äì100 ‚ÇΩ)
        </button>

        <!-- –ë–ª–æ–∫ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –∏ –≤—ã–≤–æ–¥–∞ -->
        <div class="card" style="padding: 20px;">
            <div class="flex-row" style="margin-bottom: 14px;">
                <span style="font-weight: 600;">üë• –ü—Ä–∏–≥–ª–∞—Å–∏–ª –¥—Ä—É–∑–µ–π</span>
                <span class="badge" id="referralCountDisplay">0 / 3</span>
            </div>
            <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ (–¥–ª—è –≤—ã–≤–æ–¥–∞) -->
            <div class="progress-bar">
                <div class="progress-fill" id="referralProgress" style="width: 0%;"></div>
            </div>
            <div class="flex-row hint-text" style="margin-top: 8px;">
                <span>–Ω—É–∂–Ω–æ 3 –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥—Ä—É–≥–∞</span>
                <span id="referralStatus">–Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</span>
            </div>

            <hr>

            <div class="flex-row" style="margin-bottom: 6px;">
                <span style="font-weight: 500;">üîó –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞</span>
                <button class="btn" id="copyRefLink" style="padding: 8px 16px; font-size: 0.85rem;">–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
            <div class="card-subtle" style="word-break: break-all; font-size: 0.85rem;">
                <span id="refLink">https://t.me/mini_bot?start=ref_123abc</span>
            </div>

            <!-- –£—Å–ª–æ–≤–∏—è –≤—ã–≤–æ–¥–∞ + –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä -->
            <div style="margin-top: 22px;">
                <div class="flex-row">
                    <span style="font-weight: 500;">üí∏ –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</span>
                    <span class="badge" id="withdrawStatusBadge">–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ</span>
                </div>

                <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É—Å–ª–æ–≤–∏–π (–ø–æ–¥–ø–∏—Å–∫–∏ –¥—Ä—É–∑–µ–π –∏ —Ç.–¥.) -->
                <div class="progress-bar" style="margin: 16px 0 8px;">
                    <div class="progress-fill" id="withdrawProgressFill" style="width: 0%;"></div>
                </div>
                <div class="flex-row hint-text">
                    <span>–ø–æ–¥–ø–∏—Å–∫–∏ –¥—Ä—É–∑–µ–π</span>
                    <span id="withdrawProgressText">0/3</span>
                </div>
                <div class="flex-row hint-text" style="margin-top: 4px;">
                    <span>–±–∞–ª–∞–Ω—Å ‚â•50‚ÇΩ</span>
                    <span id="balanceConditionIcon">‚ùå</span>
                </div>

                <!-- –ö–Ω–æ–ø–∫–∞ –≤—ã–≤–æ–¥–∞ (–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏) -->
                <button class="btn btn-block" id="withdrawBtn" disabled style="margin-top: 22px; opacity: 0.5; background: var(--accent-light); color: var(--text-secondary);">
                    üì§ –í—ã–≤–µ—Å—Ç–∏
                </button>
            </div>
        </div>

        <!-- –ò—Å—Ç–æ—Ä–∏—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π / –≤—ã–≤–æ–¥–æ–≤ (–∞–∫–∫—É—Ä–∞—Ç–Ω—ã–π —Å–ø–∏—Å–æ–∫) -->
        <div class="card" style="padding: 18px;">
            <span style="font-weight: 600; margin-bottom: 16px; display: block;">üìã –ò—Å—Ç–æ—Ä–∏—è</span>
            <div id="historyList" style="display: flex; flex-direction: column; gap: 14px;">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ JS, –Ω–æ –¥–ª—è –æ–±—Ä–∞–∑—Ü–∞ –ø–∞—Ä–∞ –∑–∞–ø–∏—Å–µ–π -->
                <div class="flex-row hint-text">
                    <span>‚ûï –ë–æ–Ω—É—Å –∑–∞ —Ä–µ–∫–ª–∞–º—É</span>
                    <span style="color: var(--success);">+15 ‚ÇΩ</span>
                </div>
                <div class="flex-row hint-text">
                    <span>‚ûï –ë–æ–Ω—É—Å –∑–∞ —Ä–µ–∫–ª–∞–º—É</span>
                    <span style="color: var(--success);">+42 ‚ÇΩ</span>
                </div>
                <div class="flex-row hint-text" style="color: var(--text-secondary);">
                    <span>üì§ –ó–∞–ø—Ä–æ—Å –≤—ã–≤–æ–¥–∞</span>
                    <span>‚Äî</span>
                </div>
            </div>
        </div>

        <!-- –ú–∞–ª–µ–Ω—å–∫–∏–π —Ñ—É—Ç–µ—Ä (–¥–æ–ø. –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è) -->
        <div class="flex-row hint-text" style="justify-content: center; margin-top: 8px;">
            <span>Mini App ¬∑ –ø–ª–æ—Å–∫–∏–π –¥–∏–∑–∞–π–Ω</span>
        </div>
    </div>

    <script>
        (function() {
            // ---------- –°–û–°–¢–û–Ø–ù–ò–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø (–∏–º–∏—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö) ----------
            // –î–ª—è –≤—Å—Ç–∞–≤–∫–∏ —Ä–µ–∞–ª—å–Ω–æ–π backend-–ª–æ–≥–∏–∫–∏: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫ —á–µ—Ä–µ–∑ —Ç–µ–ª–µ–≥—Ä–∞–º, 
            // –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤, —Ä–µ—Ñ–µ—Ä–∞–ª—ã –ø—Ä–∏—Ö–æ–¥—è—Ç —Å —Å–µ—Ä–≤–µ—Ä–∞.

            let balance = 42;          // —Å—Ç–∞—Ä—Ç–æ–≤—ã–π –±–∞–ª–∞–Ω—Å (–¥–ª—è –¥–µ–º–æ)
            let referrals = 2;          // –∫–æ–ª-–≤–æ –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–ø–∏—Å–∞–ª–∏—Å—å –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª–∏—Å—å
            const requiredReferrals = 3;
            const minWithdraw = 50;

            // –ò—Å—Ç–æ—Ä–∏—è (–º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤)
            let history = [
                { type: 'bonus', amount: 15, date: '—Ç–æ–ª—å–∫–æ —á—Ç–æ' },
                { type: 'bonus', amount: 42, date: '2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥' },
            ];

            // –§–ª–∞–≥ –ø–æ–¥–ø–∏—Å–∫–∏ (–∏–º–∏—Ç–∞—Ü–∏—è: –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è "—è –ø–æ–¥–ø–∏—Å–∞–ª—Å—è" —Å–∫—Ä—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω)
            let isSubscribed = false;   // –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ false

            // ---------- –≠–õ–ï–ú–ï–ù–¢–´ DOM ----------
            const subscriptionScreen = document.getElementById('subscriptionScreen');
            const mainApp = document.getElementById('mainApp');
            const subscribeBtn = document.getElementById('fakeSubscribeBtn');
            const balanceSpan = document.getElementById('balanceDisplay');
            const bonusBtn = document.getElementById('bonusBtn');
            const referralCountSpan = document.getElementById('referralCountDisplay');
            const referralProgress = document.getElementById('referralProgress');
            const referralStatus = document.getElementById('referralStatus');
            const withdrawBtn = document.getElementById('withdrawBtn');
            const withdrawStatusBadge = document.getElementById('withdrawStatusBadge');
            const withdrawProgressFill = document.getElementById('withdrawProgressFill');
            const withdrawProgressText = document.getElementById('withdrawProgressText');
            const balanceConditionIcon = document.getElementById('balanceConditionIcon');
            const historyDiv = document.getElementById('historyList');
            const themeSwitch = document.getElementById('themeSwitch');
            const copyRefBtn = document.getElementById('copyRefLink');
            const refLinkSpan = document.getElementById('refLink');

            // ---------- –§–£–ù–ö–¶–ò–ò –û–ë–ù–û–í–õ–ï–ù–ò–Ø UI ----------
            function updateUI() {
                // 1. –ë–∞–ª–∞–Ω—Å —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
                balanceSpan.textContent = balance;
                balanceSpan.classList.add('animate-balance');
                setTimeout(() => balanceSpan.classList.remove('animate-balance'), 300);

                // 2. –ü—Ä–æ–≥—Ä–µ—Å—Å —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
                const referralProgressPercent = (referrals / requiredReferrals) * 100;
                referralProgress.style.width = `${Math.min(referralProgressPercent, 100)}%`;
                referralCountSpan.textContent = `${referrals} / ${requiredReferrals}`;
                referralStatus.textContent = referrals >= requiredReferrals ? '‚úÖ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ' : '‚è≥ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç';

                // 3. –£—Å–ª–æ–≤–∏—è –¥–ª—è –≤—ã–≤–æ–¥–∞
                const balanceOk = balance >= minWithdraw;
                const referralsOk = referrals >= requiredReferrals;
                const canWithdraw = balanceOk && referralsOk;

                // –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –≤—ã–≤–æ–¥–∞ (–∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π: 50% –±–∞–ª–∞–Ω—Å, 50% —Ä–µ—Ñ–µ—Ä–∞–ª—ã)
                let totalConditions = 0;
                if (balanceOk) totalConditions += 1;
                if (referralsOk) totalConditions += 1;
                const withdrawProgressPercent = (totalConditions / 2) * 100; // –¥–≤–∞ —É—Å–ª–æ–≤–∏—è
                withdrawProgressFill.style.width = `${withdrawProgressPercent}%`;
                withdrawProgressText.textContent = `${referrals}/${requiredReferrals}`;
                balanceConditionIcon.textContent = balanceOk ? '‚úÖ' : '‚ùå';
                
                if (canWithdraw) {
                    withdrawBtn.disabled = false;
                    withdrawBtn.style.opacity = '1';
                    withdrawBtn.style.background = 'var(--success)';
                    withdrawBtn.style.color = 'white';
                    withdrawStatusBadge.textContent = '–º–æ–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏';
                    withdrawStatusBadge.style.background = '#d1fae5';
                    withdrawStatusBadge.style.color = '#065f46';
                } else {
                    withdrawBtn.disabled = true;
                    withdrawBtn.style.opacity = '0.5';
                    withdrawBtn.style.background = 'var(--accent-light)';
                    withdrawBtn.style.color = 'var(--text-secondary)';
                    withdrawStatusBadge.textContent = '–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ';
                    withdrawStatusBadge.style.background = '#fee2e2';
                    withdrawStatusBadge.style.color = '#991b1b';
                }

                // 4. –û–±–Ω–æ–≤–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é (–≤—ã–≤–µ–¥–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)
                // –û—á–∏—â–∞–µ–º –∏ —Ä–µ–Ω–¥–µ—Ä–∏–º –∑–∞–Ω–æ–≤–æ (–¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã)
                historyDiv.innerHTML = '';
                if (history.length === 0) {
                    historyDiv.innerHTML = '<div class="hint-text">–ø–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç</div>';
                } else {
                    // –ü–æ–∫–∞–∂–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –∑–∞–ø–∏—Å–∏
                    history.slice(-3).reverse().forEach(item => {
                        const row = document.createElement('div');
                        row.className = 'flex-row hint-text';
                        if (item.type === 'bonus') {
                            row.innerHTML = `<span>‚ûï –ë–æ–Ω—É—Å –∑–∞ —Ä–µ–∫–ª–∞–º—É</span><span style="color: var(--success);">+${item.amount} ‚ÇΩ</span>`;
                        } else if (item.type === 'withdraw') {
                            row.innerHTML = `<span>üì§ –í—ã–≤–æ–¥</span><span>-${item.amount} ‚ÇΩ</span>`;
                        } else {
                            row.innerHTML = `<span>${item.type}</span><span>${item.amount} ‚ÇΩ</span>`;
                        }
                        historyDiv.appendChild(row);
                    });
                }
            }

            // –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ –∏—Å—Ç–æ—Ä–∏—é
            function addHistoryEntry(type, amount) {
                history.push({ type, amount, date: '—Ç–æ–ª—å–∫–æ —á—Ç–æ' });
                if (history.length > 5) history.shift(); // –æ—Å—Ç–∞–≤–∏–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5
                updateUI();
            }

            // ---------- –ò–ú–ò–¢–ê–¶–ò–Ø –ü–†–û–í–ï–†–ö–ò –ü–û–î–ü–ò–°–ö–ò ----------
            subscribeBtn.addEventListener('click', function() {
                // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ä–µ–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Telegram WebApp API 
                // –∏–ª–∏ –≤—ã–∑–æ–≤ backend –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∫–∏.
                // –°–µ–π—á–∞—Å –ø—Ä–æ—Å—Ç–æ —Å–∫—Ä—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
                isSubscribed = true;
                subscriptionScreen.classList.add('hidden');
                mainApp.classList.remove('hidden');
                // –ù–µ–±–æ–ª—å—à–æ–π Initial UI –∞–ø–¥–µ–π—Ç
                updateUI();
            });

            // ---------- –ü–û–õ–£–ß–ï–ù–ò–ï –ë–û–ù–£–°–ê (–ü–†–û–°–ú–û–¢–† –†–ï–ö–õ–ê–ú–´) ----------
            bonusBtn.addEventListener('click', function() {
                // –ó–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–∑–æ–≤ –ø–æ–∫–∞–∑–∞ —Ä–µ–∫–ª–∞–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, Telegram Ad –∏–ª–∏ –æ—Ñ—Ñ–µ—Ä)
                // –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ ‚Äî –Ω–∞—á–∏—Å–ª—è–µ–º –±–æ–Ω—É—Å.
                
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—É—é —Å—É–º–º—É –æ—Ç 1 –¥–æ 100
                const bonusAmount = Math.floor(Math.random() * 100) + 1; 
                balance += bonusAmount;

                // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
                addHistoryEntry('bonus', bonusAmount);

                // –ê–Ω–∏–º–∞—Ü–∏—è —É–∂–µ –≤–Ω—É—Ç—Ä–∏ updateUI (—Ü–∏—Ñ—Ä–∞ –º–µ–Ω—è–µ—Ç—Å—è —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π)
                updateUI();

                // –ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–ø–ª—ã–≤–∞—é—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ, –Ω–æ –ø–æ –¢–ó –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∞–Ω–∏–º–∞—Ü–∏–∏ —Ü–∏—Ñ—Ä
            });

            // ---------- –†–ï–§–ï–†–ê–õ–¨–ù–ê–Ø –°–ò–°–¢–ï–ú–ê (–∏–º–∏—Ç–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥—Ä—É–≥–∞) ----------
            // –î–ª—è –¥–µ–º–æ: –±—É–¥–µ–º —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –ø–æ –∫–ª–∏–∫—É –Ω–∞ "–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É" (–Ω–µ —Å–æ–≤—Å–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–æ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å–Ω–æ)
            // –∏–ª–∏ –¥–æ–±–∞–≤–∏–º —Å–∫—Ä—ã—Ç—ã–π –º–µ—Ö–∞–Ω–∏–∑–º. –õ—É—á—à–µ —Å–æ–∑–¥–∞–¥–∏–º –∫–Ω–æ–ø–∫—É –ø–ª—é—Å –¥–ª—è —Ç–µ—Å—Ç–∞.
            // –ß—Ç–æ–±—ã UI –±—ã–ª –∂–∏–≤—ã–º, —Å–¥–µ–ª–∞–µ–º +1 –¥—Ä—É–≥ –ø–æ –¥–æ–ª–≥–æ–º—É –Ω–∞–∂–∞—Ç–∏—é –Ω–∞ —Å—á—ë—Ç—á–∏–∫ (–ø—Ä–æ—Å—Ç–æ –¥–ª—è —Ç–µ—Å—Ç–∞)
            referralCountSpan.addEventListener('dblclick', function(e) {
                // –£–≤–µ–ª–∏—á–∏–º —á–∏—Å–ª–æ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ (–¥–æ 3 –º–∞–∫—Å) ‚Äî –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                if (referrals < requiredReferrals) {
                    referrals++;
                    updateUI();
                }
            });

            // —Ç–∞–∫–∂–µ –º–æ–∂–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ (–¥–ª—è —Ç–µ—Å—Ç–∞) –ø–æ Alt+–∫–ª–∏–∫ –Ω–∞ –±–µ–π–¥–∂
            referralStatus.addEventListener('click', function(e) {
                if (e.altKey) {
                    referrals = 0;
                    updateUI();
                }
            });

            // –ö–Ω–æ–ø–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–∏
            copyRefBtn.addEventListener('click', function() {
                navigator.clipboard.writeText(refLinkSpan.textContent).then(() => {
                    alert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞! (–≤ –±—ç–∫–µ–Ω–¥–µ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ)');
                    // –ü—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —Å—á–µ—Ç—á–∏–∫ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¥—Ä—É–≥–∞, –Ω–æ –∑–¥–µ—Å—å –ø—Ä–æ—Å—Ç–æ —Ç–µ—Å—Ç
                });
            });

            // ---------- –í–´–í–û–î –°–†–ï–î–°–¢–í ----------
            withdrawBtn.addEventListener('click', function() {
                if (withdrawBtn.disabled) return;
                // –°–ø–∏—Å—ã–≤–∞–µ–º –±–∞–ª–∞–Ω—Å (–º–æ–∂–Ω–æ —á–∞—Å—Ç—å –∏–ª–∏ –≤—Å—ë)
                const withdrawAmount = balance; // –≤—ã–≤–æ–¥–∏–º –≤—Å—ë –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã
                if (withdrawAmount >= minWithdraw) {
                    balance = 0;
                    addHistoryEntry('withdraw', withdrawAmount);
                    updateUI();
                    alert(`–ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ ${withdrawAmount} ‚ÇΩ —Å–æ–∑–¥–∞–Ω–∞ (–∏–º–∏—Ç–∞—Ü–∏—è).`);
                } else {
                    alert('–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞ 50‚ÇΩ');
                }
            });

            // ---------- –¢–Å–ú–ù–ê–Ø –¢–ï–ú–ê ----------
            themeSwitch.addEventListener('click', function() {
                document.body.classList.toggle('dark');
                themeSwitch.textContent = document.body.classList.contains('dark') ? '‚òÄÔ∏è —Å–≤–µ—Ç–ª–∞—è' : 'üåì —Ç—ë–º–Ω–∞—è';
            });

            // ---------- –ù–ê–ß–ê–õ–¨–ù–ê–Ø –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ----------
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º overlay –ø–æ–¥–ø–∏—Å–∫–∏ (isSubscribed = false), —Å–∫—Ä—ã—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
            // –Ω–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ UI
            updateUI();

            // –Ω–µ–±–æ–ª—å—à–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞: –º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å —ç–∫—Ä–∞–Ω –ø–æ–¥–ø–∏—Å–∫–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∏–∂–µ)
            // –†–ê—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ–±—ã —Å—Ä–∞–∑—É –≤–∏–¥–µ—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
            // subscriptionScreen.classList.add('hidden');
            // mainApp.classList.remove('hidden');
        })();
    </script>

    <!-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è backend-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ (–≤—Å—Ç–∞–≤–∫–∞ –ª–æ–≥–∏–∫–∏) -->
    <!--
        ========== –í–°–¢–ê–í–ö–ê BACKEND-–õ–û–ì–ò–ö–ò ==========
        1. –ü–û–î–ü–ò–°–ö–ê: 
           - –†–µ–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ `Telegram.WebApp.initData` –∏–ª–∏ –≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ `telegram-web-app/checkSubscription`.
           - –í–º–µ—Å—Ç–æ `fakeSubscribeBtn` –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ —Å–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –∫–∞–Ω–∞–ª—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, @bonus_news, @daily_offers, @crypto_trend).
           - –ü—Ä–∏ —É—Å–ø–µ—Ö–µ ‚Äì —Å–∫—Ä—ã—Ç—å overlay, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `isSubscribed = true`.

        2. –ù–ê–ß–ò–°–õ–ï–ù–ò–ï –ë–û–ù–£–°–ê:
           - –í –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ `bonusBtn` –≤—ã–∑–≤–∞—Ç—å –ø–æ–∫–∞–∑ —Ä–µ–∫–ª–∞–º–Ω–æ–≥–æ –æ—Ñ—Ñ–µ—Ä–∞ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Telegram Web App showPopup –∏–ª–∏ –æ—Ç–∫—Ä—ã—Ç—å —Å—Å—ã–ª–∫—É).
           - –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ–∫–ª–∞–º—ã ‚Äì –∑–∞–ø—Ä–æ—Å –∫ backend –Ω–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ–π —Å—É–º–º—ã (1-100). –û—Ç–≤–µ—Ç –æ–±–Ω–æ–≤–ª—è–µ—Ç –±–∞–ª–∞–Ω—Å.
           - –°–æ—Ö—Ä–∞–Ω—è—Ç—å –∏—Å—Ç–æ—Ä–∏—é –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

        3. –†–ï–§–ï–†–ê–õ–´:
           - –£–Ω–∏–∫–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: `https://t.me/–≤–∞—à_–±–æ—Ç?start=ref_{user_id}`.
           - –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –¥—Ä—É–≥–∞ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∏–º —É—Å–ª–æ–≤–∏–π (–ø–æ–¥–ø–∏—Å–∫–∞ + –ø–µ—Ä–≤—ã–π –±–æ–Ω—É—Å) ‚Äì —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —Å—á–µ—Ç—á–∏–∫ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ (`referrals`) —É —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
           - –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –∏ —Å—Ç–∞—Ç—É—Å –≤—ã–≤–æ–¥–∞ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.

        4. –í–´–í–û–î:
           - –ö–Ω–æ–ø–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –∫–æ–≥–¥–∞ `balance >= minWithdraw` (50) –∏ `referrals >= 3`.
           - –ü—Ä–∏ –∫–ª–∏–∫–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –≤—ã–ø–ª–∞—Ç—ã. –í –¥–µ–º–æ –ø—Ä–æ—Å—Ç–æ —Å–ø–∏—Å—ã–≤–∞–µ–º –±–∞–ª–∞–Ω—Å.
           - –î–æ–±–∞–≤–ª—è—Ç—å –∑–∞–ø–∏—Å—å –≤ –∏—Å—Ç–æ—Ä–∏—é –≤—ã–≤–æ–¥–æ–≤.

        5. –ò–°–¢–û–†–ò–Ø:
           - –ó–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–±–æ–Ω—É—Å—ã/–≤—ã–≤–æ–¥—ã). 

        6. –¢–Å–ú–ù–ê–Ø –¢–ï–ú–ê: –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ `Telegram.WebApp.themeParams`.
        =============================================
    -->
</body>
</html>
