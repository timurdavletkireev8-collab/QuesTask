<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NEON BONUS ¬∑ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,400;14..32,500;14..32,600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ (–æ—Å–Ω–æ–≤–Ω–∞—è) */
        :root {
            --bg: #0a0c12;
            --surface: #14181f;
            --surface-raised: #1e232c;
            --text-primary: #f0f4fa;
            --text-secondary: #9aa8b9;
            --text-tertiary: #5f6c80;
            --accent: #7c85ff;
            --accent-soft: #2f3545;
            --bonus: #6c8cff;
            --success: #2bbf7c;
            --success-bg: #1a3a30;
            --border-dim: #262e3a;
            --border-subtle: #1f2733;
            --shadow-depth: 0 12px 30px -10px #00000080;
            --radius-xl: 28px;
            --radius-lg: 22px;
            --radius-md: 16px;
            --transition: all 0.2s cubic-bezier(0.22, 1, 0.36, 1);
        }

        body {
            background-color: var(--bg);
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            padding: 0 0 24px 0;
        }

        .app-container {
            width: 100%;
            max-width: 420px;
            background-color: var(--bg);
            padding: 20px 18px 24px;
            display: flex;
            flex-direction: column;
            gap: 18px;
        }

        .card {
            background-color: var(--surface);
            border-radius: var(--radius-xl);
            padding: 24px 20px;
            border: 1px solid var(--border-subtle);
            box-shadow: var(--shadow-depth);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border: none;
            background-color: var(--accent-soft);
            color: var(--accent);
            font-weight: 600;
            font-size: 1rem;
            padding: 14px 22px;
            border-radius: 60px;
            transition: var(--transition);
            cursor: pointer;
            width: 100%;
            gap: 8px;
        }

        .btn-primary {
            background-color: var(--accent);
            color: white;
        }

        .btn:active {
            transform: scale(0.97);
            opacity: 0.7;
        }

        .btn:disabled {
            opacity: 0.35;
            pointer-events: none;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background-color: var(--border-dim);
            border-radius: 12px;
            overflow: hidden;
            margin: 14px 0 8px;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--accent);
            width: 0%;
            border-radius: 12px;
            transition: width 0.3s ease;
        }

        .balance-large {
            font-size: 3rem;
            font-weight: 500;
            letter-spacing: -0.03em;
            color: var(--text-primary);
        }

        .badge {
            background-color: var(--accent-soft);
            padding: 4px 14px;
            border-radius: 40px;
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--accent);
        }

        .badge-success {
            background-color: var(--success-bg);
            color: var(--success);
        }

        .hint-text {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .flex-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
        }

        @keyframes gentlePop {
            0% { opacity: 0.3; transform: translateY(5px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        
        .animate-balance {
            animation: gentlePop 0.25s ease-out forwards;
        }

        .subscription-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: var(--bg);
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(4px);
        }

        .hidden {
            display: none !important;
        }

        .channel-badge-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            margin: 24px 0 12px;
        }

        .channel-badge {
            background: var(--accent-soft);
            color: var(--accent);
            padding: 6px 16px;
            border-radius: 50px;
            font-size: 0.9rem;
            border: 1px solid var(--border-dim);
        }

        .history-item {
            background-color: var(--surface-raised);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            border: 1px solid var(--border-dim);
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
        }
    </style>
</head>
<body>
    <!-- –≠–ö–†–ê–ù –ü–û–î–ü–ò–°–ö–ò -->
    <div id="subscriptionScreen" class="subscription-overlay">
        <div class="card" style="max-width: 360px; text-align: center;">
            <span style="font-size: 44px; margin-bottom: 8px; display: block;">üîí</span>
            <h2 style="font-weight: 500; margin-bottom: 10px;">–Ω—É–∂–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∞</h2>
            <p class="hint-text" style="margin-bottom: 26px;">–ø–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ –∫–∞–Ω–∞–ª—ã, —á—Ç–æ–±—ã –≤–æ–π—Ç–∏</p>
            
            <div class="channel-badge-list">
                <span class="channel-badge">@bonus_wave</span>
                <span class="channel-badge">@daily_offers</span>
                <span class="channel-badge">@crypto_pulse</span>
            </div>

            <button class="btn btn-primary" id="checkSubscriptionBtn">
                ‚úÖ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
            </button>
            <p class="hint-text" style="margin-top: 18px; font-size: 0.75rem;">* –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –∏–∑ –±–∞–∑—ã</p>
        </div>
    </div>

    <!-- –û–°–ù–û–í–ù–û–ô –ò–ù–¢–ï–†–§–ï–ô–° (—Å–∫—Ä—ã—Ç –¥–æ –ø–æ–¥–ø–∏—Å–∫–∏) -->
    <div id="mainApp" class="app-container hidden">
        <!-- –ë–∞–ª–∞–Ω—Å -->
        <div class="card">
            <div class="flex-row">
                <span class="badge">üí∞ –±–∞–ª–∞–Ω—Å</span>
                <span class="hint-text" id="userId">–∑–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
            <div style="margin-top: 16px;">
                <span class="balance-large" id="balanceDisplay">0</span>
                <span style="font-size: 1.5rem; color: var(--text-tertiary);">‚ÇΩ</span>
            </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ –±–æ–Ω—É—Å–∞ -->
        <button class="btn" id="bonusBtn" style="background: var(--bonus); color: white; padding: 18px;">
            ‚ú® –ø–æ–ª—É—á–∏—Ç—å –±–æ–Ω—É—Å (1‚Äì100 ‚ÇΩ)
        </button>

        <!-- –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ -->
        <div class="card">
            <div class="flex-row" style="margin-bottom: 16px;">
                <span style="font-weight: 600;">üë• —Ä–µ—Ñ–µ—Ä–∞–ª—ã</span>
                <span class="badge" id="referralCount">0/3</span>
            </div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="referralProgress" style="width: 0%;"></div>
            </div>

            <div style="margin-top: 20px;">
                <div class="flex-row" style="margin-bottom: 8px;">
                    <span>—Ç–≤–æ—è —Å—Å—ã–ª–∫–∞</span>
                    <button class="btn" id="copyRefLink" style="padding: 6px 12px; width: auto;">–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
                <div class="card" style="background: var(--surface-raised); padding: 12px; word-break: break-all;">
                    <span id="refLink" class="hint-text">–∑–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
            </div>
        </div>

        <!-- –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤ -->
        <div class="card">
            <div class="flex-row" style="margin-bottom: 16px;">
                <span style="font-weight: 600;">üí∏ –≤—ã–≤–æ–¥</span>
                <span class="badge" id="withdrawStatus">‚õî –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω</span>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="withdrawProgress" style="width: 0%;"></div>
            </div>

            <div class="flex-row" style="margin: 12px 0;">
                <span class="hint-text">–Ω—É–∂–Ω–æ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤: <span id="referralNeeded">0/3</span></span>
                <span class="hint-text">–±–∞–ª–∞–Ω—Å ‚â•50‚ÇΩ: <span id="balanceCondition">‚ùå</span></span>
            </div>

            <button class="btn" id="withdrawBtn" disabled>
                üì§ –≤—ã–≤–µ—Å—Ç–∏
            </button>
        </div>

        <!-- –ò—Å—Ç–æ—Ä–∏—è -->
        <div class="card">
            <span style="font-weight: 600; margin-bottom: 16px; display: block;">üìã –∏—Å—Ç–æ—Ä–∏—è</span>
            <div id="historyList"></div>
        </div>
    </div>

    <script>
        // ==============================================
        // –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï –ö NEON (–í–ê–®–ê –ë–ê–ó–ê –î–ê–ù–ù–´–•)
        // ==============================================
        const NEON_CONFIG = {
            host: 'ep-sparkling-forest-aic1svb9-pooler.c-4.us-east-1.aws.neon.tech',
            database: 'neondb',
            user: 'neondb_owner',
            password: 'npg_GrJdL7gwel2H',
            ssl: true
        };

        // ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram (–¥–ª—è —Ç–µ—Å—Ç–∞ –º–æ–∂–Ω–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –ª—é–±–æ–µ —á–∏—Å–ª–æ)
        const TELEGRAM_ID = Math.floor(Math.random() * 1000000); // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

        // ==============================================
        // –§–£–ù–ö–¶–ò–ò –î–õ–Ø –†–ê–ë–û–¢–´ –° –ë–ê–ó–û–ô –î–ê–ù–ù–´–•
        // ==============================================
        async function queryNeon(sql, params = []) {
            const url = `https://${NEON_CONFIG.host}/sql`;
            
            // –ë–∞–∑–æ–≤–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
            const auth = btoa(`${NEON_CONFIG.user}:${NEON_CONFIG.password}`);
            
            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Basic ${auth}`,
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        query: sql,
                        params: params
                    })
                });

                if (!response.ok) {
                    const error = await response.text();
                    console.warn('SQL Warning:', error);
                    return [];
                }

                const data = await response.json();
                return data;
            } catch (error) {
                console.error('Database error:', error);
                return [];
            }
        }

        // ==============================================
        // –°–û–ó–î–ê–ù–ò–ï –¢–ê–ë–õ–ò–¶ (–í–´–ü–û–õ–ù–ò–¢–°–Ø –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò)
        // ==============================================
        async function initDatabase() {
            // –°–æ–∑–¥–∞—ë–º —Ç–∞–±–ª–∏—Ü—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            await queryNeon(`
                CREATE TABLE IF NOT EXISTS users (
                    id BIGSERIAL PRIMARY KEY,
                    telegram_id BIGINT UNIQUE NOT NULL,
                    balance INTEGER DEFAULT 0,
                    referral_code VARCHAR(50) UNIQUE,
                    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
                )
            `);

            // –¢–∞–±–ª–∏—Ü–∞ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
            await queryNeon(`
                CREATE TABLE IF NOT EXISTS referrals (
                    id BIGSERIAL PRIMARY KEY,
                    referrer_id BIGINT NOT NULL,
                    referred_id BIGINT NOT NULL,
                    bonus_received BOOLEAN DEFAULT FALSE,
                    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
                )
            `);

            // –¢–∞–±–ª–∏—Ü–∞ –∏—Å—Ç–æ—Ä–∏–∏
            await queryNeon(`
                CREATE TABLE IF NOT EXISTS history (
                    id BIGSERIAL PRIMARY KEY,
                    user_id BIGINT NOT NULL,
                    amount INTEGER NOT NULL,
                    type VARCHAR(20) NOT NULL,
                    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
                )
            `);

            console.log('‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ç–æ–≤–∞');
        }

        // ==============================================
        // –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø
        // ==============================================
        async function loadUserData() {
            try {
                // –ü—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                let users = await queryNeon(
                    'SELECT * FROM users WHERE telegram_id = $1',
                    [TELEGRAM_ID]
                );

                let user;
                if (users.length === 0) {
                    // –°–æ–∑–¥–∞—ë–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    const referralCode = `ref_${Math.random().toString(36).substr(2, 8)}`;
                    await queryNeon(
                        'INSERT INTO users (telegram_id, balance, referral_code) VALUES ($1, $2, $3)',
                        [TELEGRAM_ID, 0, referralCode]
                    );
                    user = { balance: 0, referral_code: referralCode };
                } else {
                    user = users[0];
                }

                // –ü–æ–ª—É—á–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
                const referrals = await queryNeon(
                    'SELECT COUNT(*) as count FROM referrals WHERE referrer_id = $1 AND bonus_received = true',
                    [TELEGRAM_ID]
                );

                // –ü–æ–ª—É—á–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é
                const history = await queryNeon(
                    'SELECT * FROM history WHERE user_id = $1 ORDER BY created_at DESC LIMIT 10',
                    [TELEGRAM_ID]
                );

                return {
                    balance: user.balance || 0,
                    referralCode: user.referral_code || `ref_${TELEGRAM_ID}`,
                    referralsCount: referrals[0]?.count || 0,
                    history: history || []
                };
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –æ—à–∏–±–∫–∞
                return {
                    balance: 0,
                    referralCode: `ref_${TELEGRAM_ID}`,
                    referralsCount: 0,
                    history: []
                };
            }
        }

        // ==============================================
        // –°–û–•–†–ê–ù–ï–ù–ò–ï –î–ê–ù–ù–´–•
        // ==============================================
        async function saveBonus(userId, amount) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
            await queryNeon(
                'UPDATE users SET balance = balance + $1 WHERE telegram_id = $2',
                [amount, userId]
            );
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
            await queryNeon(
                'INSERT INTO history (user_id, amount, type) VALUES ($1, $2, $3)',
                [userId, amount, 'bonus']
            );
        }

        async function saveWithdraw(userId, amount) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
            await queryNeon(
                'UPDATE users SET balance = 0 WHERE telegram_id = $1',
                [userId]
            );
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
            await queryNeon(
                'INSERT INTO history (user_id, amount, type) VALUES ($1, $2, $3)',
                [userId, amount, 'withdraw']
            );
        }

        // ==============================================
        // –°–û–°–¢–û–Ø–ù–ò–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
        // ==============================================
        let appState = {
            balance: 0,
            referrals: 0,
            referralCode: '',
            history: []
        };

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateUI() {
            // –ë–∞–ª–∞–Ω—Å
            document.getElementById('balanceDisplay').textContent = appState.balance;
            document.getElementById('balanceDisplay').classList.add('animate-balance');
            setTimeout(() => document.getElementById('balanceDisplay').classList.remove('animate-balance'), 250);
            
            // –†–µ—Ñ–µ—Ä–∞–ª—ã
            const referralPercent = (appState.referrals / 3) * 100;
            document.getElementById('referralProgress').style.width = `${Math.min(referralPercent, 100)}%`;
            document.getElementById('referralCount').textContent = `${appState.referrals}/3`;
            
            // –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞
            document.getElementById('refLink').textContent = `https://t.me/–≤–∞—à_–±–æ—Ç?start=${appState.referralCode}`;
            document.getElementById('userId').textContent = `ID: ${TELEGRAM_ID}`;
            
            // –£—Å–ª–æ–≤–∏—è –≤—ã–≤–æ–¥–∞
            const balanceOk = appState.balance >= 50;
            const referralsOk = appState.referrals >= 3;
            const canWithdraw = balanceOk && referralsOk;
            
            document.getElementById('referralNeeded').textContent = `${appState.referrals}/3`;
            document.getElementById('balanceCondition').textContent = balanceOk ? '‚úÖ' : '‚ùå';
            
            // –ü—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–≤–æ–¥–∞
            let conditionsMet = 0;
            if (balanceOk) conditionsMet++;
            if (referralsOk) conditionsMet++;
            document.getElementById('withdrawProgress').style.width = `${(conditionsMet / 2) * 100}%`;
            
            // –ö–Ω–æ–ø–∫–∞ –≤—ã–≤–æ–¥–∞
            const withdrawBtn = document.getElementById('withdrawBtn');
            if (canWithdraw) {
                withdrawBtn.disabled = false;
                withdrawBtn.style.background = 'var(--success)';
                document.getElementById('withdrawStatus').textContent = '‚úÖ –¥–æ—Å—Ç—É–ø–µ–Ω';
            } else {
                withdrawBtn.disabled = true;
                withdrawBtn.style.background = 'var(--accent-soft)';
                document.getElementById('withdrawStatus').textContent = '‚õî –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω';
            }
            
            // –ò—Å—Ç–æ—Ä–∏—è
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = '';
            
            if (appState.history.length === 0) {
                historyList.innerHTML = '<div class="history-item hint-text">–ø–æ–∫–∞ –Ω–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π</div>';
            } else {
                appState.history.slice(0, 7).forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'history-item';
                    
                    if (item.type === 'bonus') {
                        div.innerHTML = `<span class="hint-text">‚ûï –±–æ–Ω—É—Å</span>
                                        <span style="color: var(--success);">+${item.amount} ‚ÇΩ</span>`;
                    } else {
                        div.innerHTML = `<span class="hint-text">üì§ –≤—ã–≤–æ–¥</span>
                                        <span style="color: var(--text-tertiary);">-${item.amount} ‚ÇΩ</span>`;
                    }
                    historyList.appendChild(div);
                });
            }
        }

        // ==============================================
        // –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô
        // ==============================================
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏
        document.getElementById('checkSubscriptionBtn').addEventListener('click', async () => {
            // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ä–µ–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Telegram API
            document.getElementById('subscriptionScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            const userData = await loadUserData();
            appState = {
                balance: userData.balance,
                referrals: userData.referralsCount,
                referralCode: userData.referralCode,
                history: userData.history
            };
            updateUI();
        });

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –±–æ–Ω—É—Å–∞
        document.getElementById('bonusBtn').addEventListener('click', async () => {
            const bonusAmount = Math.floor(Math.random() * 100) + 1;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –±–∞–∑—É
            await saveBonus(TELEGRAM_ID, bonusAmount);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            appState.balance += bonusAmount;
            appState.history.unshift({ type: 'bonus', amount: bonusAmount });
            if (appState.history.length > 10) appState.history.pop();
            
            updateUI();
        });

        // –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤
        document.getElementById('withdrawBtn').addEventListener('click', async () => {
            if (appState.balance >= 50 && appState.referrals >= 3) {
                const withdrawAmount = appState.balance;
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –±–∞–∑—É
                await saveWithdraw(TELEGRAM_ID, withdrawAmount);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                appState.history.unshift({ type: 'withdraw', amount: withdrawAmount });
                appState.balance = 0;
                updateUI();
                
                alert('‚úÖ –ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ —Å–æ–∑–¥–∞–Ω–∞');
            }
        });

        // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Å—ã–ª–∫–∏
        document.getElementById('copyRefLink').addEventListener('click', () => {
            navigator.clipboard.writeText(document.getElementById('refLink').textContent);
            alert('‚úÖ –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞');
        });

        // –î–ª—è —Ç–µ—Å—Ç–∞: –¥–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –Ω–∞ —Å—á—ë—Ç—á–∏–∫–µ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
        document.getElementById('referralCount').addEventListener('dblclick', async () => {
            if (appState.referrals < 3) {
                appState.referrals++;
                updateUI();
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –±–∞–∑—É (–¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏)
                await queryNeon(
                    'INSERT INTO referrals (referrer_id, referred_id, bonus_received) VALUES ($1, $2, $3)',
                    [TELEGRAM_ID, TELEGRAM_ID + 1, true]
                );
            }
        });

        // ==============================================
        // –ó–ê–ü–£–°–ö –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
        // ==============================================
        (async function init() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
            await initDatabase();
            console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ');
        })();
    </script>
</body>
</html>
